(self["webpackChunkxstarter_frontend"]=self["webpackChunkxstarter_frontend"]||[]).push([[220],{96220:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>N});var o=n(83673);const r={class:"q-my-lg"};function s(e,t,n,s,a,i){const l=(0,o.up)("StoreDexTrades"),u=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(u,{class:"flex flex-center"},{default:(0,o.w5)((()=>[(0,o._)("div",r,[(0,o.Wm)(l)])])),_:1})}n(10071);var a=n(61959),i=n(76638),l=n(33437),u=n(62323);const c={class:"row"},d={class:"full-width justify-center col-12 row q-mt-md"},m={class:"col-12 justify-center row"},h={class:"col-12 justify-center row q-gutter-md q-mt-md"},g={class:"col-12 justify-center row q-gutter-md q-mt-md"},p={key:0,class:"col-12"},k={key:1,class:"q-gutter-y-lg col-12"},y=(0,o._)("br",null,null,-1),f=(0,o._)("br",null,null,-1),b=(0,o._)("br",null,null,-1),v=(0,o._)("br",null,null,-1);function w(e,t,n,r,s,a){const i=(0,o.up)("q-btn"),l=(0,o.up)("q-select");return(0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("div",d,[(0,o._)("div",m,[(0,o.Wm)(i,{label:"listen for volume",outline:"",onClick:e.listenAndFilterTransaction},null,8,["onClick"]),(0,o.Wm)(i,{label:"Compute",outline:"",onClick:e.computeVolume},null,8,["onClick"])]),(0,o._)("div",h,[(0,o.Wm)(l,{modelValue:e.computeTimeOption,"onUpdate:modelValue":t[0]||(t[0]=t=>e.computeTimeOption=t),outlined:"",options:e.computeTimeOptions,label:"Select Time Range To Compute"},null,8,["modelValue","options"]),(0,o.Wm)(l,{modelValue:e.computePaginationTimeBlockOption,"onUpdate:modelValue":t[1]||(t[1]=t=>e.computePaginationTimeBlockOption=t),outlined:"",options:e.computePaginationTimeBlockOptions,label:"Select Pagination Time Block, when computing, data for time block will be computed "},null,8,["modelValue","options"]),(0,o.Wm)(i,{label:"Compute Paginate",outline:"",onClick:e.computeVolumePaginated},null,8,["onClick"])]),(0,o._)("div",g,[(0,o.Wm)(l,{modelValue:e.sortByValue,"onUpdate:modelValue":t[2]||(t[2]=t=>e.sortByValue=t),outlined:"",options:e.computedSortBy,label:"Sort By"},null,8,["modelValue","options"])])]),e.listeningDate?((0,o.wg)(),(0,o.iD)("div",p," Started Listening "+(0,u.zw)(e.listeningDate),1)):(0,o.kq)("",!0),e.tokenAndVolume.length?((0,o.wg)(),(0,o.iD)("div",k,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.tokenAndVolumeSorted[e.sortByValue.value],(t=>((0,o.wg)(),(0,o.iD)("div",{class:"text-center",key:t.tokenAddr},[(0,o.Uk)(" Token Address : "+(0,u.zw)(t.tokenAddr)+" ",1),y,(0,o.Uk)(" Sell Volume: "+(0,u.zw)(e.$ethers.utils.formatEther(t.sellVolume.toString()))+" ",1),f,(0,o.Uk)(" Buy Volume: "+(0,u.zw)(e.$ethers.utils.formatEther(t.buyVolume.toString())),1),b,(0,o.Uk)(" total: "+(0,u.zw)(e.$ethers.utils.formatEther(t.total.toString())),1),v,(0,o.Uk)(" net: "+(0,u.zw)(e.$ethers.utils.formatEther(t.net.toString()))+" ",1),(0,o.Wm)(i,{flat:"",label:"view on BscScan",onClick:n=>e.openLink(`https://bscscan.com/token/${t.tokenAddr}`)},null,8,["onClick"]),(0,o.Wm)(i,{flat:"",label:"view on Poocoin",onClick:n=>e.openLink(`https://poocoin.app/tokens/${t.tokenAddr}`)},null,8,["onClick"])])))),128))])):(0,o.kq)("",!0)])}n(7098),n(17070);var T=n(81830),A=n(40019);const C=["function balanceOf(address owner) view returns (uint256 balance)","function totalSupply() view returns (uint)","function name() view  returns (string)","function symbol() view returns (string)"],P=["function balanceOf(address owner) view returns (uint256 balance)","function totalSupply() view returns (uint)","function name() view  returns (string)","function symbol() view returns (string)"],V=["event PairCreated(address indexed token0, address indexed token1, address pair, uint)","function getPair(address tokenA, address tokenB) view returns (address pair)","function allPairs(uint) view returns (address pair)"],E=["function balanceOf(address owner) view returns (uint256 balance)","function totalSupply() view returns (uint)","function name() view  returns (string)","function symbol() view returns (string)","function getReserves() view returns (uint112 reserve0, uint112 reserve1, uint32 blockTimestampLast)"],B=(0,o.aZ)({name:"StoreDexTrades",setup(){const e=(0,o.f3)("$getProvider"),t=(0,o.f3)("$getSigner"),n=(0,o.f3)("$getLaunchPadContract"),r=(0,o.f3)("$connectedAccounts");let s=(0,o.f3)("$chainId");const l=(0,o.f3)("$getConnectedAndPermissioned"),u=i.ethers.utils.getAddress("0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c"),c=new i.ethers.providers.JsonRpcProvider("https://bsc-dataseed.binance.org/"),d=()=>c,m=new i.ethers.utils.Interface(T.A7),h=()=>m,g=new i.ethers.utils.Interface(T.af),p=()=>g,k=i.ethers.utils.getAddress("0x10ED43C718714eb63d5aA57B78B54704E256024E"),y=new i.ethers.Contract(k,P,c),f=()=>y,b=new i.ethers.Contract("0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73",V,c),v=()=>b,w=e=>new i.ethers.Contract(e,C,c);return A.log("provider is ",e()),{getProvider:e,getLocalProvider:d,getPCakeRouter:f,getPCakeRouterInterface:h,getPCakePairInterface:p,getPCakeFactory:v,getERC20Contract:w,getSigner:t,getLaunchPadContract:n,getConnectedAndPermissioned:l,connectedAccount:r,chainId:s,pCakeRouterAddr:k,current:(0,a.iH)(1),WETH:u}},data(){return{arrayOfTxs:[],minAmtInEthers:5,searchHistoric:!0,symbolFilter:"",arrayOfFilteredDexPairByAmount:[],arrayOfFilteredDexPairBySymbol:[],arrayOfERC20:[],tokenWithIndex:{},tokenAndVolume:[],currentBlockNumber:0,provider:null,listeningDate:null,dbName:"BlockchainData",objectStoreName:"DexTrades",dateTimeString:"",dateTimeRange:{from:"",to:""},computeTimeOption:{label:"Last 60 minutes",value:"getCurrentLast60Minutes"},computePaginationTimeBlockOption:{label:"120 seconds",value:120},sortByValue:{label:"positive net",value:0}}},computed:{tokenAndVolumeSorted(){const e=[...this.tokenAndVolume].sort((function(e,t){return t.net-e.net}));return[e.slice(0,100),e.slice(-100).reverse()]},computedStartTimestamp(){if(!this.dateTimeString)return"";const e=new Date(this.dateTimeString);return e.getTime()},computeTimeOptions(){return[{label:"Current Hour to Date",value:"getCurrentHourTimestamp"},{label:"Last 60 minutes",value:"getCurrentLast60Minutes"},{label:"Current Day To Date",value:"getCurrentDayTimestamp"},{label:"Last 24 Hours",value:"getCurrentLast24Hours"}]},computePaginationTimeBlockOptions(){return[{label:"60 seconds time block",value:60},{label:"120 seconds time block",value:120},{label:"5 minute time block",value:300}]},computedSortBy(){return[{label:"positive net",value:0},{label:"negative net",value:1}]}},methods:{openLink(e){(0,l.Z)(e)},async computeVolume(){this.tokenWithIndex={},this.tokenAndVolume=[];const e=this.getCurrentHourTimestamp(!0);A.log("currenthourtimestamp",e-1),await this.$indexDBFactory.getNumberedIndexByRange(this.dbName,this.objectStoreName,"timestamp",e-7201,e+3601,this.calculateAndPopulateData)},async computeVolumePaginated(){A.log("function should be",this[this.computeTimeOption.value],this.computeTimeOptions.value);const e=this[this.computeTimeOption.value](!0);this.tokenWithIndex={},this.tokenAndVolume=[],A.log("currenthourtimestamp",e[0]-1),await this.$indexDBFactory.getPaginatedNumberedIndexByRange(this.dbName,this.objectStoreName,"timestamp",e[0]-1,e[1],this.computePaginationTimeBlockOption.value,this.calculateAndPopulateAllData)},getCurrentHourTimestamp(e){const t=new Date;t.setMinutes(0,0,0),A.log("time is",t.getTime());const n=Date.now();return e?[Math.floor(t.getTime()/1e3),Math.floor(n/1e3)]:[t.getTime(),n]},getCurrentLast60Minutes(e){const t=Date.now(),n=t-36e5;return e?[Math.floor(n/1e3),Math.floor(t/1e3)]:[n,t]},getCurrentDayTimestamp(e){const t=new Date;t.setHours(0,0,0,0);const n=Date.now();return A.log("time is",t.getTime(),n),e?[Math.floor(t.getTime()/1e3),Math.floor(n/1e3)]:[t.getTime(),n]},getCurrentLast24Hours(e){const t=Date.now(),n=t-864e5;return e?[Math.floor(n/1e3),Math.floor(t/1e3)]:[n,t]},async calculateAndPopulateData(e){A.log("data is "),"undefined"===typeof this.tokenWithIndex[e.tokenAddr]&&(this.tokenWithIndex[e.tokenAddr]=this.tokenAndVolume.push({tokenAddr:e.tokenAddr,buyVolume:i.ethers.BigNumber.from(0),sellVolume:i.ethers.BigNumber.from(0),total:i.ethers.BigNumber.from(0),net:i.ethers.BigNumber.from(0)})-1);const t=this.tokenWithIndex[e.tokenAddr];this.tokenAndVolume[t].sellVolume=this.tokenAndVolume[t].sellVolume.add(e.sellVolume),this.tokenAndVolume[t].buyVolume=this.tokenAndVolume[t].buyVolume.add(e.buyVolume),this.tokenAndVolume[t].total=this.tokenAndVolume[t].total.add(e.buyVolume).add(e.sellVolume),this.tokenAndVolume[t].net=this.tokenAndVolume[t].net.sub(e.sellVolume).add(e.buyVolume)},async calculateAndPopulateAllData(e){A.log("calculating");for(let t=0;t<e.length-1;t++){const n=e[t];"undefined"===typeof this.tokenWithIndex[n.tokenAddr]&&(this.tokenWithIndex[n.tokenAddr]=this.tokenAndVolume.push({tokenAddr:n.tokenAddr,buyVolume:i.ethers.BigNumber.from(0),sellVolume:i.ethers.BigNumber.from(0),total:i.ethers.BigNumber.from(0),net:i.ethers.BigNumber.from(0)})-1);const o=this.tokenWithIndex[n.tokenAddr];this.tokenAndVolume[o].sellVolume=this.tokenAndVolume[o].sellVolume.add(n.sellVolume),this.tokenAndVolume[o].buyVolume=this.tokenAndVolume[o].buyVolume.add(n.buyVolume),this.tokenAndVolume[o].total=this.tokenAndVolume[o].total.add(n.buyVolume).add(n.sellVolume),this.tokenAndVolume[o].net=this.tokenAndVolume[o].net.sub(n.sellVolume).add(n.buyVolume)}},async listenAndFilterTransaction(){A.log("trying to listen");const e=this.getLocalProvider();A.log("provider is",e),e.on("block",(async t=>{this.currentBlockNumber=t;const n=await e.getBlockWithTransactions(t);this.getTxRouterAddress(n)})),this.listeningDate=new Date},async getTxRouterAddress(e){const t=e.transactions,n=e.timestamp,o=[];for(const r of t)if(r.to===this.pCakeRouterAddr){const e=this.getPCakeRouterInterface(),t=e.parseTransaction(r),s=t.name;switch(s){case"swapExactTokensForETH":await this.storeSwapExactTokensForETH(t,n,o);break;case"swapExactTokensForETHSupportingFeeOnTransferTokens":await this.storeSwapExactTokensForETH(t,n,o);break;case"swapTokensForExactETH":A.log("swapTokensForExactETH data is",t),await this.storeSwapExactTokensForETH(t,n,o);break;case"swapETHForExactTokens":await this.storeSwapETHForExactTokens(t,n,o);break;case"swapExactETHForTokens":await this.storeSwapETHForExactTokens(t,n,o);break;case"swapExactETHForTokensSupportingFeeOnTransferTokens":await this.storeSwapETHForExactTokens(t,n,o);break;default:break}}A.log("formated dat is",o),this.$indexDBFactory.addData(this.dbName,this.objectStoreName,o,(e=>{}),(e=>{A.log("on error",e)}))},async storeSwapExactTokensForETH(e,t,n){const o=e.args.path[0];T.Ig[o]||n.push({tokenAddr:o,timestamp:t,buyVolume:i.ethers.BigNumber.from(0),sellVolume:e.args.amountOutMin||e.args.amountOut})},async storeSwapETHForExactTokens(e,t,n){const o=e.args.path[e.args.path.length-1];T.Ig[o]||n.push({tokenAddr:o,timestamp:t,buyVolume:e.value,sellVolume:i.ethers.BigNumber.from(0)})},async filterCakePairTx(e){A.log(e);for(const t of e)if(t.to!==this.pCakeRouterAddr){A.log("tx is",t);const e=this.getPCakeRouterInterface(),n=e.parseTransaction(t);A.log("decoded data is",n);break}},async listenForBSCTransaction(){const e=new this.$ethers.providers.JsonRpcProvider("https://bsc-dataseed.binance.org/");A.log("provider is",e),e.on("pending",(e=>{A.log("tx creates is",e.creates,e.hash),e.creates&&this.arrayOfTxs.push({hash:e.hash,creates:e.creates})})),A.log("provider is",e)},async listenAndFilterPairCreatedByWETHReserve(){if(this.searchHistoric){A.log("min amout str",this.minAmtInEthers);const e=i.ethers.utils.parseEther(this.minAmtInEthers.toString());A.log("big number for ethers",e);let t=await this.getHistoricPairCreatedEvents();await this.filterHistoryPairEventsByLiquidity(t,e)}},async listenAndFilterPairCreatedBySymbol(){if(this.searchHistoric){let e=await this.getHistoricPairCreatedEvents();await this.filterHistoryPairEventsBySymbol(e)}this.filterRealtimePairEventsBySymbol()},async getHistoricPairCreatedEvents(){const e=this.getPCakeFactory(),t=await e.queryFilter("PairCreated",-5e3,"latest");return t},async filterHistoryPairEventsByLiquidity(e=[],t){A.log("events in history filter is",e);for(let n=0;n<e.length;n++){let o=e[n],r=await o.decode(o.data,o.topics);r.token1===this.WETH?(A.log("token 1 is weth",r.token1===this.WETH,r.token0,this.WETH),this.queryAndFilterPairByAmount(r.pair,t,r.token0,"reserve1")):r.token0===this.WETH&&(A.log("token 0 is weth",r.token0===this.WETH,r.token1,this.WETH),this.queryAndFilterPairByAmount(r.pair,t,r.token1,"reserve0"))}},async queryAndFilterPairByAmount(e,t,n,o){const r=await this.queryPairForReserves(e);A.log("reserves is",r,r[o].gte(t)),r[o].gte(t)?this.arrayOfFilteredDexPairByAmount.push({pairAddr:e,tokenAddr:n,WETHBal:i.ethers.utils.formatEther(r[o]),reserveName:o}):A.log("not greater than ",this.minAmtInEthers)},async filterHistoryPairEventsBySymbol(e=[]){A.log("events in history filter is",e);const t=this.symbolFilter.toUpperCase();for(let n=0;n<e.length;n++){let o=e[n],r=await o.decode(o.data,o.topics);r.token1===this.WETH?this.queryAndFilterPairBySymbol(r.pair,t,r.token0):r.token0===this.WETH&&this.queryAndFilterPairBySymbol(r.pair,t,r.token1)}},async filterRealtimePairEventsBySymbol(){const e=this.getPCakeFactory();A.log("starting listen for event and filter by symbol"),e.on("PairCreated",(async(e,t,n,o,r)=>{const s=this.symbolFilter.toUpperCase();t===this.WETH?await this.queryAndFilterPairBySymbol(n,s,e):e===this.WETH&&await this.queryAndFilterPairBySymbol(n,s,t)})),A.log("listen for event and filter by symbol started")},async queryAndFilterPairBySymbol(e,t,n){const o=this.getERC20Contract(n),r=await o.symbol();if(r.toUpperCase()===t){const t=await o.name();this.arrayOfFilteredDexPairBySymbol.push({pairAddr:e,tokenAddr:n,symbol:r,name:t})}else A.log(`tokensymbol not equals to ${t} but rather: ${r.toUpperCase()}`,e)},async queryPairForReserves(e){const t=new i.ethers.Contract(e,E,this.getLocalProvider());return A.log("pair Address for",t),await t.getReserves()}},mounted(){this.$indexDBFactory.setupDatabaseAndObjectStore(this.dbName,this.objectStoreName,null,[["tokenAddr",!1],["buyVolume",!1],["sellVolume",!1],["timestamp",!1]])}});var x=n(48240),S=n(29560),F=n(85626),H=n(96662),D=n(34842),O=n(7518),W=n.n(O);B.render=w;const I=B;W()(B,"components",{QBtn:x.Z,QSelect:S.Z,QDate:F.Z,QTime:H.Z,QInput:D.Z});var R=n(40019);const $=["function balanceOf(address owner) view returns (uint256 balance)","function totalSupply() view returns (uint)","function name() view  returns (string)","function symbol() view returns (string)"],q=(0,o.aZ)({name:"TradingTools",components:{StoreDexTrades:I},setup(){const e=(0,o.f3)("$getProvider"),t=(0,o.f3)("$getSigner"),n=(0,o.f3)("$getLaunchPadContract"),r=(0,o.f3)("$connectedAccounts");let s=(0,o.f3)("$chainId");const l=(0,o.f3)("$getConnectedAndPermissioned"),u=new i.ethers.providers.JsonRpcProvider("https://bsc-dataseed.binance.org/"),c=()=>u,d=new i.ethers.Contract("0x10ED43C718714eb63d5aA57B78B54704E256024E",$,u),m=()=>d;return R.log("provider is ",e()),{getProvider:e,getLocalProvider:c,getPCakeRouter:m,getSigner:t,getLaunchPadContract:n,getConnectedAndPermissioned:l,connectedAccount:r,chainId:s,current:(0,a.iH)(1)}},data(){return{arrayOfTxs:[],arrayOfERC20:[],erc20ABI:["function balanceOf(address owner) view returns (uint256 balance)","function totalSupply() view returns (uint)","function name() view  returns (string)","function symbol() view returns (string)"],provider:null}},methods:{openLink(e){(0,l.Z)(e)},async listenForTransaction(){const e=this.getProvider();R.log("provider is",e),e.on("pending",(e=>{R.log("tx creates is",e.creates),this.creates&&this.arrayOfTxs.push({hash:e.hash,creates:e.creates})})),R.log("provider is",e)},async listenForBSCTransaction(){const e=new this.$ethers.providers.JsonRpcProvider("https://bsc-dataseed.binance.org/");R.log("provider is",e),e.on("pending",(e=>{R.log("tx creates is",e.creates,e.hash),e.creates&&this.arrayOfTxs.push({hash:e.hash,creates:e.creates})})),R.log("provider is",e)},async listenAndFilterTransaction(){const e=this.getLocalProvider();R.log("provider is",e),e.on("block",(async t=>{const n=await e.getBlockWithTransactions(t);this.getTxWithContractCreation(n.transactions)})),R.log("provider is",e)},async getTxWithContractCreation(e){for(const t of e)if(t.creates){R.log("tx creates",t.creates);const e=await this.checkIfERC20(t.creates);this.arrayOfTxs.push(t),e&&this.arrayOfERC20.push({hash:t.hash,tokenAddr:t.creates,name:e})}},async checkIfERC20(e){const t=this.getLocalProvider(),n=new this.$ethers.Contract(e,this.erc20ABI,t);let o;R.log("contract variable created",n);try{o=await n.name()}catch(r){return R.log("not an erc20 token"),null}return R.log("is erc20 name is",o),o}},mounted(){}});var L=n(24379);q.render=s;const N=q;W()(q,"components",{QPage:L.Z,QBtn:x.Z})}}]);